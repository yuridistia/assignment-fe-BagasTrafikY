<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Toko Barokah</title>
  <script src="vue.global.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="app" class="container">
    <h1>Toko Barokah</h1>

    <!-- Controls -->
    <div class="controls">
      <input type="text" v-model="search" placeholder="Cari produk..." />
      <select v-model="selectedCategory">
        <option value="">Semua Kategori</option>
        <option v-for="c in categories" :key="c" :value="c">{{ c }}</option>
      </select>
      <select v-model="sortOrder">
        <option value="">Urutkan Harga</option>
        <option value="asc">Termurah ‚Üí Termahal</option>
        <option value="desc">Termahal ‚Üí Termurah</option>
      </select>
    </div>

    <!-- Loading Indicator -->
    <div v-if="loading" class="loading">‚è≥ Memuat produk‚Ä¶</div>

    <!-- Tidak ada produk -->
    <div v-else-if="filteredProducts.length === 0" class="notfound">
      ‚ùå Produk tidak ditemukan
    </div>

    <!-- Products -->
    <div v-else class="grid">
      <div class="card" v-for="p in filteredProducts" :key="p.id">
        <img :src="p.image" :alt="p.title" />
        <h3 class="title">{{ p.title }}</h3>
        <p class="category">{{ p.category }}</p>
        <p class="price">Rp {{ (p.price * 16000).toLocaleString('id-ID') }}</p>
      </div>
    </div>
  </div>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          products: [],
          categories: [],
          loading: true,
          search: "",
          selectedCategory: "",
          sortOrder: ""
        }
      },
      computed: {
        filteredProducts() {
          let result = this.products;

          // üîç Pencarian (case-insensitive)
          if (this.search) {
            const q = this.search.toLowerCase();
            result = result.filter(p => p.title.toLowerCase().includes(q));
          }

          // üìÇ Filter kategori
          if (this.selectedCategory) {
            result = result.filter(p => p.category === this.selectedCategory);
          }

          // ‚ÜïÔ∏è Sort harga
          if (this.sortOrder === "asc") {
            result = [...result].sort((a, b) => a.price - b.price);
          } else if (this.sortOrder === "desc") {
            result = [...result].sort((a, b) => b.price - a.price);
          }

          return result;
        }
      },
      mounted() {
        // Ambil data produk
        fetch("https://fakestoreapi.com/products")
          .then(r => r.json())
          .then(data => {
            this.products = data;
            this.loading = false;
          });

        // Ambil data kategori
        fetch("https://fakestoreapi.com/products/categories")
          .then(r => r.json())
          .then(data => {
            this.categories = data;
          });
      }
    }).mount("#app");
  </script>
</body>
</html>
